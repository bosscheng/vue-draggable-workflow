(function(t){function e(e){for(var i,s,l=e[0],r=e[1],d=e[2],c=0,m=[];c<l.length;c++)s=l[c],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&m.push(o[s][0]),o[s]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);u&&u(e);while(m.length)m.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,l=1;l<n.length;l++){var r=n[l];0!==o[r]&&(i=!1)}i&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},o={app:0},a=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/vue-draggable-workflow/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var u=r;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},5052:function(t,e,n){"use strict";var i=n("b37d"),o=n.n(i);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("workflow")],1)},a=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flow-layout"},[n("div",{staticClass:"flow-editor"},[n("div",{staticClass:"flow-tools"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"自动排列",placement:"top-start"}},[n("div",{staticClass:"tool-item",attrs:{title:""},on:{click:t.handleSort}},[n("span",{staticClass:"icon-duiqi"})])]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"清空",placement:"top-start"}},[n("div",{staticClass:"tool-item",on:{click:t.handleClear}},[n("span",{staticClass:"icon-clear"})])]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"获取JSON数据",placement:"top-start"}},[n("div",{staticClass:"tool-item",on:{click:t.handleGetData}},[n("span",{staticClass:"icon-json"})])]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"网格",placement:"top-start"}},[n("div",{staticClass:"tool-item",on:{click:function(e){t.toggleGridLine=!t.toggleGridLine}}},[n("span",{class:t.toggleGridLineClass})])])],1),n("div",{staticClass:"flow-zoom",attrs:{"data-zoom":t.canvasDataRoom+"%"}},[n("div",{staticClass:"zoom-btn"},[n("el-button",{class:{"el-button--primary":t.canvasRoomMinusEnable},attrs:{size:"mini",icon:"el-icon-minus",circle:""},on:{click:t.handleMinusCanvas}})],1),n("div",{staticClass:"zoom-btn"},[n("el-button",{class:{"el-button--primary":t.canvasRoomPlusEnable},attrs:{size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.handlePlusCanvas}})],1)]),n("div",{staticClass:"canvas-container",class:{"show-grid":t.toggleGridLine},attrs:{"data-zoom":t.canvasDataRoom}},[n("div",{ref:"campaignCanvas",style:t.canvasRoomScaleStyle,attrs:{id:"campaignCanvas"}},[t._l(t.flowList,(function(e,i){return[n("div",{key:i,staticClass:"node-content-wrap",style:{left:e.left+"px",top:e.top+"px"},attrs:{id:e.uuid},on:{mousedown:t.handleFlowMoveDown,mouseup:function(n){t.handleChangeFlowPosition(e,n)},click:function(n){return n.stopPropagation(),function(n){t.handleEditFlowItem(e,n)}(n)}}},[n("div",{staticClass:"node-content"},[n("draggable",{ref:e.uuid,refInFor:!0,staticClass:"node-temp-small",attrs:{group:{name:"sortable",pull:!1,put:!0}}}),e.groupType===t.flowTypeConstant.action?[n("div",{staticClass:"flow-item node"},[n("div",{staticClass:"step-img",class:e.className}),n("div",{staticClass:"step-title"},[t._v(t._s(e.name))])]),n("div",{staticClass:"flow-text"},[n("div",{staticClass:"text-line"},[n("span",[t._v(t._s(e.formData&&e.formData.stepName))]),n("i",{staticClass:"el-icon-close flow-delete",on:{click:function(n){return n.stopPropagation(),t.handleDeleteFlowItem(e)}}})])])]:e.groupType===t.flowTypeConstant.condition?[n("div",{staticClass:"flow-item node-square"},[n("div",{staticClass:"square"},[n("div",{staticClass:"step-img",class:e.className})])]),n("div",{staticClass:"flow-text"},[n("div",{staticClass:"text-line"},[n("span",[t._v(t._s(e.formData&&e.formData.stepName))]),n("i",{staticClass:"el-icon-close flow-delete",on:{click:function(n){return n.stopPropagation(),t.handleDeleteFlowItem(e)}}})]),n("div",{staticClass:"text-line1"},[e.formData&&e.formData.ifNodeTitle?[n("span",{staticClass:"text-content"},[t._v(t._s(e.formData.ifNodeTitle))])]:t._e()],2)])]:e.groupType===t.flowTypeConstant.flow?[n("div",{staticClass:"flow-item node node-circle"},[n("div",{staticClass:"step-img",class:e.className})]),n("div",{staticClass:"flow-text"},[n("div",{staticClass:"text-line"},[n("span",[t._v(t._s(e.formData&&e.formData.stepName))]),e.type!==t.flowItemTypeConstant.startNode?n("i",{staticClass:"el-icon-close flow-delete",on:{click:function(n){return n.stopPropagation(),t.handleDeleteFlowItem(e)}}}):t._e()])])]:t._e(),e.groupType===t.flowTypeConstant.temp?[n("draggable",{ref:"tempNode",refInFor:!0,staticClass:"flow-item node-temp node-temp-img",attrs:{id:e.uuid,group:{name:"sortable",pull:!1,put:!0}}})]:t._e()],2)])]}))],2)]),n("div",{staticClass:"flow-editor-sidebar"},[t._l(t.flowAllList,(function(e,i){return[n("draggable",t._b({key:i,ref:e.ref,refInFor:!0,staticClass:"items-box",attrs:{list:e.children,group:{name:"sortable",pull:"clone",put:!1},move:t.handleFlowMoveItem,sort:!1},on:{start:t.handleFlowMoveStart,end:t.handleFlowMoveEnd}},"draggable",t.dragConfig,!1),[t._l(e.children,(function(i,o){return[e.type===t.flowTypeConstant.action?[i.hidden?t._e():n("div",{key:o,staticClass:"node",attrs:{title:i.name,"data-id":i.id,"data-type":i.type,"data-group":i.groupType}},[n("div",{staticClass:"step-img",class:i.className}),n("div",{staticClass:"step-title"},[t._v(t._s(i.name))])])]:e.type===t.flowTypeConstant.flow?[i.hidden?t._e():n("div",{key:o,staticClass:"node node-circle",attrs:{title:i.name,"data-id":i.id,"data-type":i.type,"data-group":i.groupType}},[n("div",{staticClass:"step-img",class:i.className})])]:e.type===t.flowTypeConstant.condition?[i.hidden?t._e():n("div",{key:o,staticClass:"node-square",attrs:{title:i.name,"data-id":i.id,"data-type":i.type,"data-group":i.groupType}},[n("div",{staticClass:"square"},[n("div",{staticClass:"step-img",class:i.className})])])]:t._e()]}))],2)]}))],2)]),n("el-dialog",{staticClass:"dialog-wrap",attrs:{visible:t.dialogObj.visible,"show-close":!1,width:"500px"},on:{"update:visible":function(e){return t.$set(t.dialogObj,"visible",e)}}},[t.dialogObj.editType===t.flowItemTypeConstant.list?[n("list-form",{on:{handleCheck:t.handleSelectFlowItem}})]:[n("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[t.dialogObj.editType!==t.flowItemTypeConstant.startNode?n("i",{staticClass:"el-icon-arrow-left",on:{click:t.handleGoList}}):t._e(),n("span",{staticClass:"desc"},[t._v(t._s(t.dialogObj.editType))])]),n("div",{staticClass:"dialog-body"},[t.dialogObj.editType?[n(t.dialogFlowItemComponent,{ref:"flowEditComponent",tag:"component",attrs:{editItem:t.dialogObj.editForm},on:{"update:editItem":function(e){return t.$set(t.dialogObj,"editForm",e)},"update:edit-item":function(e){return t.$set(t.dialogObj,"editForm",e)}}})]:t._e()],2)],n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:t.handleCloseDialog}},[t._v("取 消")]),t.dialogObj.editType!==t.flowItemTypeConstant.list?n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleTempFlowFormData}},[t._v("确 定")]):t._e()],1)],2),n("el-dialog",{attrs:{title:"JSON数据",visible:t.dialogVisible,width:"700px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.dialogVisible?n("div",{ref:"preShow",staticClass:"pre-show"}):t._e(),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("关 闭")])],1)])],1)},l=[],r=(n("99af"),n("7db0"),n("c740"),n("4160"),n("c975"),n("d81d"),n("a434"),n("b0c0"),n("a9e3"),n("b64b"),n("ac1f"),n("5319"),n("159b"),n("075d")),d=n.n(r),u=n("fc80"),c={action:"action",condition:"condition",flow:"flow",temp:"temp"},m={startNode:"startNode",endNode:"endNode",waitNode:"waitNode",tempNode:"tempNode",nodeNode:"nodeNode",ifNode:"ifNode",expandNode:"expandNode",list:"list"},f={action:[{id:"nodeNode",type:"nodeNode",className:"step-tag",name:"节点",groupType:"action"}],condition:[{id:"conditionNode",type:"ifNode",className:"step-if",name:"条件判断",groupType:"condition"},{id:"switchNode",type:"expandNode",className:"step-expand",name:"条件分组",groupType:"condition"}],flow:[{id:"startNode",type:"startNode",className:"step-start",name:"start",groupType:"flow",hidden:!0},{id:"stopNode",type:"endNode",className:"step-end",name:"结束",groupType:"flow"}],temp:[{id:"tempNode",type:"tempNode",className:"step-temp",name:"temp",groupType:"temp"}]},p=[{type:c.action,ref:"actionFlow",children:f.action},{type:c.flow,ref:"flowFlow",children:f.flow},{type:c.condition,ref:"conditionFlow",children:f.condition}],h=(n("d3b7"),n("25f0"),n("53ca"));function w(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)}))}function v(t){var e="";return"object"===Object(h["a"])(t)?(e=JSON.stringify(t),e=JSON.parse(e)):e=t,e}n("1276");var g=function(t){var e=/^\s*(.*?)\s+$/;return t.replace(e,"$1")};function I(t,e){if(t&&e){for(var n=t.className,i=(e||"").split(" "),o=0,a=i.length;o<a;o++){var s=i[o];s&&(t.classList?t.classList.add(s):x(t,s)||(n+=" "+s))}t.classList||(t.className=n)}}function F(t,e){if(t&&e){for(var n=" "+t.className+" ",i=(e||"").split(" "),o=0,a=i.length;o<a;o++){var s=i[o];s&&(t.classList?t.classList.remove(s):x(t,s)||(n=n.replace(" "+s+" "," ")))}t.classList||(t.className=g(n))}}function x(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("classNames should not contain space");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function b(t,e){try{return window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.currentStyle[e]}catch(n){return null}}function y(t){var e=b(t,"width");return"auto"===e&&(e=t.offsetWidth),parseFloat(e)}var C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.flowAllList,(function(e){return[n("div",{staticClass:"items-box"},[t._l(e.children,(function(i,o){return[e.type===t.flowTypeConstant.action?[i.hidden?t._e():n("div",{staticClass:"node",on:{click:function(e){return t.handleClick(i)}}},[n("div",{staticClass:"step-img",class:i.className}),n("div",{staticClass:"step-title"},[t._v(t._s(i.name))])])]:e.type===t.flowTypeConstant.flow?[i.hidden?t._e():n("div",{staticClass:"node node-circle",on:{click:function(e){return t.handleClick(i)}}},[n("div",{staticClass:"step-img",class:i.className})])]:e.type===t.flowTypeConstant.condition?[i.hidden?t._e():n("div",{staticClass:"node-square",on:{click:function(e){return t.handleClick(i)}}},[n("div",{staticClass:"square"},[n("div",{staticClass:"step-img",class:i.className})])])]:t._e()]}))],2)]}))],2)},N=[],T={name:"ListForm",data:function(){return{flowAllList:p,flowTypeConstant:c}},methods:{handleClick:function(t){this.$emit("handleCheck",t)}}},O=T,D=(n("6523"),n("2877")),j=Object(D["a"])(O,C,N,!1,null,"1b772e52",null),E=j.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.tempItem,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称",prop:"stepName"}},[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:t.tempItem.stepName,callback:function(e){t.$set(t.tempItem,"stepName",e)},expression:"tempItem.stepName"}})],1)],1)],1)},$=[];function _(){return{stepName:"新建"}}var k={name:"StartNodeForm",props:{editItem:{type:Object}},data:function(){return{tempItem:_(),rules:{stepName:[{required:!0,trigger:"blur",message:"请填写名称"}]}}},created:function(){this.editItem&&this.editItem.stepName&&(this.tempItem=v(this.editItem))},methods:{validateFormData:function(){var t=this;return new Promise((function(e,n){t.$refs["dataForm"].validate((function(t){t?e():n()}))}))},formData:function(){var t=v(this.tempItem);return t}}},S=k,P=Object(D["a"])(S,L,$,!1,null,"9a7d79b6",null),U=P.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.tempItem,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称",prop:"stepName"}},[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:t.tempItem.stepName,callback:function(e){t.$set(t.tempItem,"stepName",e)},expression:"tempItem.stepName"}})],1)],1)],1)},R=[];function G(){return{stepName:"节点"}}var A={name:"nodeNodeForm",props:{editItem:{type:Object}},data:function(){return{tempItem:G(),rules:{stepName:[{required:!0,trigger:"blur",message:"请填写名称"}]}}},created:function(){this.editItem&&this.editItem.stepName&&(this.tempItem=v(this.editItem))},methods:{validateFormData:function(){var t=this;return new Promise((function(e,n){t.$refs["dataForm"].validate((function(t){t?e():n()}))}))},formData:function(){var t=v(this.tempItem);return t}}},B=A,V=Object(D["a"])(B,M,R,!1,null,"f5f0e5f8",null),q=V.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"if-node-form"},[n("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.tempItem,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"步骤名称",prop:"stepName"}},[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:t.tempItem.stepName,callback:function(e){t.$set(t.tempItem,"stepName",e)},expression:"tempItem.stepName"}})],1)],1)],1)},J=[];function H(){return{stepName:"条件判断"}}var W={name:"IfNodeForm",props:{editItem:{type:Object}},created:function(){if(this.editItem&&this.editItem.stepName){var t=v(this.editItem);this.updateData(t)}this.init()},data:function(){return{tempItem:H(),rules:{stepName:[{required:!0,trigger:"blur",message:"请填写名称"}]}}},methods:{init:function(){},updateData:function(t){this.tempItem.stepName=t.stepName},validateFormData:function(){var t=this;return new Promise((function(e,n){t.$refs["dataForm"].validate((function(t){t?e():n()}))}))},formData:function(){var t=v(this.tempItem);return t}}},K=W,Q=Object(D["a"])(K,z,J,!1,null,"783c604f",null),X=Q.exports,Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.tempItem,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"步骤名称",prop:"stepName"}},[n("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:t.tempItem.stepName,callback:function(e){t.$set(t.tempItem,"stepName",e)},expression:"tempItem.stepName"}})],1),n("el-form-item",{attrs:{label:"分支",prop:"stepName"}},[t._l(t.tempItem.ruleGroupList,(function(e,i){return[n("div",{staticClass:"expand-item"},[n("span",{staticClass:"expand-title"},[t._v("分支"+t._s(i+1)+" ")]),n("span",{staticClass:"expand-content"},[n("el-input",{attrs:{size:"small",placeholder:"placeholder"},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"ruleItem.name"}})],1),n("span",{staticClass:"el-icon-btn el-icon-remove",attrs:{title:"删除分支"},on:{click:function(e){return t.handleRemoveRuleGroup(i)}}})])]})),n("div",{staticClass:"el-icon-btn rule-content-tips el-icon-circle-plus",attrs:{title:"创建分支"},on:{click:t.handleCreateRuleGroup}})],2)],1)],1)},Z=[];function tt(){return{stepName:"条件分组",ruleGroupList:[{name:""}]}}var et={name:"ExpandNodeForm",props:{editItem:{type:Object}},data:function(){return{tempItem:tt(),rules:{stepName:[{required:!0,trigger:"blur",message:"请填写名称"}]}}},created:function(){if(this.editItem&&this.editItem.stepName){var t=v(this.editItem);this.updateData(t)}},methods:{updateData:function(t){this.tempItem=t},validateFormData:function(){var t=this;return new Promise((function(e,n){t.$refs["dataForm"].validate((function(t){t?e():n()}))}))},formData:function(){var t=v(this.tempItem);return t},handleCreateRuleGroup:function(){this.tempItem.ruleGroupList.push({name:""})},handleRemoveRuleGroup:function(t){this.tempItem.ruleGroupList.splice(t,1),0===this.tempItem.ruleGroupList.length&&this.handleCreateRuleGroup()},_message:function(t,e){this.$message({type:e||"error",message:t})}}},nt=et,it=(n("5052"),Object(D["a"])(nt,Y,Z,!1,null,"c2eb94a2",null)),ot=it.exports,at=n("e193"),st=n("2ef0"),lt=n.n(st),rt={animation:0,group:"description",disabled:!1,ghostClass:"sortable-ghost"},dt=120,ut=80,ct=30,mt=30,ft={name:"Workflow",jsPlumb:null,data:function(){return{flowTypeConstant:c,flowItemTypeConstant:m,flowAllList:p,jsPlumbInit:!1,dialogObj:{visible:!1,editType:void 0,flowUUid:void 0,editForm:void 0,isBetween:!1,flowPreUuid:void 0,flowNextUuid:void 0},dialogVisible:!1,flowList:[],dragConfig:rt,movingFlowItem:void 0,movedFlowItem:void 0,canvasDataRoom:100,toggleGridLine:!0}},components:{Draggable:u["a"],ListForm:E,StartNodeForm:U,NodeNodeForm:q,IfNodeForm:X,ExpandNodeForm:ot},mounted:function(){this.$options.jsPlumb=at["jsPlumb"].getInstance(),this.initJsPlumb(),this.initFlow()},computed:{dialogFlowItemComponent:function(){return this.dialogObj.editType+"Form"},canvasRoomMinusEnable:function(){return this.canvasDataRoom>50},canvasRoomPlusEnable:function(){return this.canvasDataRoom<100},canvasRoomScaleStyle:function(){return{transform:"scale("+this.canvasDataRoom/100+")"}},toggleGridLineClass:function(){return this.toggleGridLine?"icon-wangge-open":"icon-wangge-close"}},methods:{initFlow:function(){var t=this.createFlowItem(m.startNode);this.addTempFlowItem(t)},initJsPlumb:function(){var t=this;this.$options.jsPlumb.ready((function(){t.jsPlumbInit=!0,t.$options.jsPlumb.importDefaults({ConnectionsDetachable:!1,LogEnabled:!0})}))},createFlowConnectionLabel:function(t,e){var n=this;Array.isArray(t)||(t=[t]),t.forEach((function(t){var i=n.$options.jsPlumb.getConnections({source:t,target:e});i.forEach((function(t){t.getOverlay("nodeTempSmall").setVisible(!0),t.bind("click",n.handleFlowLabelClick)}))}))},createFlowItemLabel:function(t,e,n){var i=this;this.$nextTick((function(){var o=i.$options.jsPlumb.getConnections({source:t,target:e});o.length>0&&o[0].getOverlay("flowItemDesc").setLabel('<span class="node-item-title" title="'.concat(n,'">').concat(n,"</span>"))}))},removeFlowConnection:function(t,e){var n=this,i=this.$options.jsPlumb.getConnections({source:t,target:e});i.forEach((function(t){n.$options.jsPlumb.deleteConnection(t,{force:!0})}))},handleFlowLabelClick:function(t){var e=t.component;if(e){var n=e.sourceId,i=e.targetId;this.showDialog({isBetween:!0,flowPreUuid:n,flowNextUuid:i})}},handleEditFlowItem:function(t,e){var n=e.currentTarget;"true"===n.dataset.isClick&&this.showDialog({flowItemType:t.type,flowUuid:t.uuid,flowFormData:t.formData})},draggableFlowConnect:function(t,e,n){var i=this;function o(){i.jsPlumbInit&&i.$options.jsPlumb.connect({source:t,target:e,endpoint:"Dot",connectorStyle:{strokeStyle:"#ccc",joinStyle:"round",outlineColor:"#ccc"},connector:["Flowchart",{stub:[10,20],gap:1,cornerRadius:2,alwaysRespectStubs:!0}],endpointStyle:{fill:"transparent",outlineStroke:"transparent",outlineWidth:2},paintStyle:{stroke:"lightgray",strokeWidth:2},anchor:["BottomCenter","TopCenter"],overlays:[["PlainArrow",{width:10,length:10,location:1}],["Custom",{location:.5,id:"nodeTempSmall",create:function(){var n=i.$refs[e][0].$el;return n.dataset.target=e,n.dataset.source=t,n},visible:!1}],["Label",{location:1,id:"flowItemDesc",cssClass:"node-item-label",visible:!0}]]})}n?o():this.$nextTick((function(){o()}))},getFlowItemInitLeft:function(){var t=this.$refs.campaignCanvas,e=y(t),n=500;return e&&(n=e/2),n},createFlowItem:function(t,e,n){var i=this;n=n||{};var o=w(),a=this.getFlowItemByType(t),s=[];if(a){if(a.prev=[],a.next=[],a.formData={},a.left=this.getFlowItemInitLeft(),a.top=mt,a.uuid=o,e&&(Array.isArray(e)||(e=[e]),a.prev=e,e.forEach((function(t){var e=lt.a.find(i.flowList,(function(e){return e.uuid===t}));e&&(s.push(e),-1===e.next.indexOf(o)&&e.next.push(o))}))),s.length>0&&1===s.length){var l=s[0];n.offsetLeft?a.left=l.left+n.offsetLeft:n.left?a.left=n.left:a.left=l.left,a.top=l.top+dt}this.flowList.push(a),this.$nextTick((function(){i.$options.jsPlumb.draggable(o,{})}))}return a?o:null},updateFlowItem:function(t,e){var n=this.getFlow(e),i=this.getFlowItemByType(t);for(var o in i)n[o]=i[o];return n},deleteFlowItem:function(t){if(this.isOnePreOneNext(t)||this.isEndFlowItem(t)){var e=this.getFlowIndex(t.uuid);this.handleDeleteOnePrevOneNextFlowItem(t,e)}else if(this.isHasMoreNextFlowItem(t)){this.deleteNextFlowItem(t.uuid);var n=this.getFlow(t.prev[0]);if(this.isIfFlowItem(n.type))this.addIfOneTempFlowItem(n.uuid,n.nextIfId===t.uuid);else if(this.isExpandFlowItem(n.type)){var i=this.getExpandFlowItem(n,t.uuid);this.addExpandOneTempFlowItem(n,t.left,i.name)}}},handleDeleteOnePrevOneNextFlowItem:function(t,e){var n=[],i=[],o=this.flowList[e];this.flowList.forEach((function(e){e.prev.length>0&&-1!==e.prev.indexOf(t.uuid)?i.push(e):e.next.length>0&&-1!==e.next.indexOf(t.uuid)&&n.push(e)}));var a={};t.type===m.endNode&&n[0].type===m.expandNode&&(a=this.getExpandFlowItem(n[0],t.uuid)),i.forEach((function(e){var n=e.prev.indexOf(t.uuid);e.prev.splice(n,1)})),n.forEach((function(e){var n=e.next.indexOf(t.uuid);e.next.splice(n,1)})),this.flowList.splice(e,1),this.$nextTick((function(){this.$options.jsPlumb.removeAllEndpoints(t.uuid);var e=n[0],s=i[0];if(e&&s)if(e.next.push(s.uuid),s.prev.push(e.uuid),this.draggableFlowConnect(e.uuid,s.uuid,!0),s.type!==m.tempNode&&this.createFlowConnectionLabel(e.uuid,s.uuid),this.isIfFlowItem(e.type)){var l=e.nextIfId===t.uuid;l?e.nextIfId=s.uuid:e.nextElseId=s.uuid,this.createFlowItemLabel(e.uuid,s.uuid,l?"是":"否")}else if(this.isExpandFlowItem(e.type)){var r=this.getExpandFlowItem(e,o.uuid);r&&(r.nextStep=s.uuid),this.createFlowItemLabel(e.uuid,s.uuid,r.name)}if(t.type===m.endNode&&e)if(this.isIfFlowItem(e.type)){var d=e.nextIfId===t.uuid;this.addIfOneTempFlowItem(e.uuid,d)}else if(this.isExpandFlowItem(e.type)){var u=this.addExpandOneTempFlowItem(e,t.left,a.name);a.nextStep=u}else this.addTempFlowItem(e.uuid)}))},$_plumbRepaintEverything:function(){var t=this;this.$nextTick((function(){t.$options.jsPlumb.repaintEverything()}))},getFlowItemById:function(t){var e=null;return Object.keys(f).forEach((function(n){var i=f[n];if(i&&i.length>0){var o=lt.a.find(i,(function(e){return e.id===t}));o&&(e=v(o))}})),e},getFlowItemByType:function(t){var e=null;return Object.keys(f).forEach((function(n){var i=f[n];if(i&&i.length>0){var o=lt.a.find(i,(function(e){return e.type===t}));o&&(e=v(o))}})),e},handleFlowMoveItem:function(t){var e=t.to,n=t.dragged;if(n.dataset.id===m.startNode)return!1;this.movedFlowItem?this.movedFlowItem&&this.movedFlowItem!==e&&(F(this.movedFlowItem,"is-active"),this.movedFlowItem=e,I(e,"is-active")):(this.movedFlowItem=e,I(e,"is-active"))},handleDeleteFlowItem:function(t){var e=this;this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deleteFlowItem(t)})).catch((function(){}))},handleFlowMoveStart:function(t){var e=t.item,n=e.dataset;this.movingFlowItem={group:n.group,type:n.type}},handleFlowMoveEnd:function(t){var e=t.originalEvent;if(this.movedFlowItem){if(F(this.movedFlowItem,"is-active"),e.toElement!==this.movedFlowItem)return this.movedFlowItem=void 0,void(this.movingFlowItem=void 0);var n={flowItemType:this.movingFlowItem.type,flowUuid:this.movedFlowItem.id};this.movedFlowItem.dataset.source&&this.movedFlowItem.dataset.target&&(n.isBetween=!0,n.flowPreUuid=this.movedFlowItem.dataset.source,n.flowNextUuid=this.movedFlowItem.dataset.target,delete n.flowUuid),this.showDialog(n)}this.movedFlowItem=void 0,this.movingFlowItem=void 0},handleSelectFlowItem:function(t){var e=this;if(t.type!==m.endNode)this.showDialog({flowItemType:t.type,flowUuid:this.dialogObj.flowUUid});else{if(this.dialogObj.isBetween){var n=this.dialogObj.flowPreUuid,i=this.dialogObj.flowNextUuid;this.deleteNextFlowItem(i),this.$nextTick((function(){var i=e.addTempFlowItem(n);e.$nextTick((function(){e.handleAddFlowItem(t.type,i)}))}))}else this.handleAddFlowItem(t.type,this.dialogObj.flowUUid);this.initDialog()}},handleAddFlowItem:function(t,e){var n=this.updateFlowItem(t,e);if(this.createFlowConnectionLabel(n.prev,n.uuid),this.isOnePreOneNext(n))this.addTempFlowItem(e);else if(n.groupType===c.condition)if(this.isIfFlowItem(t)){var i=this.getFlow(n.prev[0]);this.isIfFlowItem(i.type)&&(i.nextIfId===n.uuid?n.left-=ct:i.nextElseId===n.uuid&&(n.left+=ct)),this.addIfTempFlowItem(e),this.$_plumbRepaintEverything()}else this.isExpandFlowItem(t)&&this.addExpandTempFlowItem(e,n.formData.ruleGroupList);return n},handleUpdateFlowItem:function(t){var e=this,n=t.flowItemType,i=t.tempFlowId,o=this.getFlow(i),a=!1,s=this.updateFlowItem(n,i);if(n!==o.type)this.isHasMoreNextFlowItem(o)&&(a=!0,o.next.forEach((function(t){e.deleteNextFlowItem(t)}))),this.isIfFlowItem(n)?this.handleUpdateIfFlowItem(s):this.isExpandFlowItem(n)?this.handleUpdateExpandFlowItem(s):a&&this.addTempFlowItem(s.uuid);else if(this.isExpandFlowItem(n)){var l=s.formData.ruleGroupList,r=s.next,d=[],u=[],c=[];if(l.forEach((function(t){var n=t.nextStep;n?(d.push(n),e.createFlowItemLabel(s.uuid,n,t.name)):u.push(t)})),c=lt.a.difference(r,d),c.length>0&&(s.next=d,c.forEach((function(t){e.deleteNextFlowItem(t)}))),u.length>0){var f=0;s.next.forEach((function(t){var n=e.getFlow(t);f<n.left&&(f=n.left)})),u.forEach((function(t,n){var i=f+(n+1)*(2*ut),o=e.createFlowItem(m.tempNode,s.uuid,{left:i});e.draggableFlowConnect(s.uuid,o),e.createFlowItemLabel(s.uuid,o,t.name),t.nextStep=o}))}}},handleUpdateIfFlowItem:function(t){var e=this;t.next.forEach((function(t){e.deleteNextFlowItem(t)})),this.$nextTick((function(){e.addIfTempFlowItem(t.uuid)}))},handleUpdateExpandFlowItem:function(t){var e=this;t.next.forEach((function(t){e.deleteNextFlowItem(t)})),this.$nextTick((function(){e.addExpandTempFlowItem(t.uuid,t.formData.ruleGroupList)}))},handleAddBetweenFlowItem:function(t){var e=this,n=t.flowItemType,i=t.preFlowId,o=t.nextFlowId,a=t.formData;this.isHasMoreNextFlowItemByType(n)?(this.deleteNextFlowItem(o),this.$nextTick((function(){var t=e.addTempFlowItem(i),o=e.getFlow(t);o.formData=a,e.$nextTick((function(){e.handleAddFlowItem(n,t)}))}))):this.handleAddBetweenCommonFlowItem(t)},handleAddBetweenCommonFlowItem:function(t){var e=this,n=t.flowItemType,i=t.preFlowId,o=t.nextFlowId,a=t.formData,s=this.getFlow(i),l={},r=this.createFlowItem(n,i,l);if(this.isIfFlowItem(s.type)){var d=this.getFlow(o),u=s.nextIfId===d.uuid;u?(s.nextIfId=r,l.offsetLeft=-ut):(s.nextElseId=r,l.offsetLeft=ut)}else if(this.isExpandFlowItem(s.type)){var c=this.getFlow(o);l.offsetLeft=c.left-s.left}var m=this.getFlow(r);m.formData=a,m.next.push(o),this.$nextTick((function(){if(e.updateBetweenFlowItem(r,o,i),e.isIfFlowItem(s.type))e.createFlowItemLabel(i,r,l.offsetLeft>0?"是":"否`");else if(e.isExpandFlowItem(s.type)){var t=e.getExpandFlowItemName(s,r);e.createFlowItemLabel(i,r,t)}}))},getExpandFlowItemName:function(t,e){var n=this.getExpandFlowItem(t,e),i="";return n&&(i=n.name),i},getExpandFlowItem:function(t,e){var n=t.formData.ruleGroupList,i=lt.a.find(n,(function(t){return t.nextStep===e}));return i},updateBetweenFlowItem:function(t,e,n){var i=this.getFlow(n),o=i.next.indexOf(e);-1!==o&&i.next.splice(e,1);var a=i.next.indexOf(t);-1===a&&i.next.push(t);var s=this.getFlow(e);s.prev=[t],this.removeFlowConnection(n,e),this.addFlowItemConnect(n,t),this.addFlowItemConnect(t,e),this.moveFlowItem(e),this.$_plumbRepaintEverything()},moveFlowItem:function(t){var e=this,n=this.getFlow(t);if(n.prev.length>0){var i=this.getFlow(n.prev[0]);n.top=i.top+dt}n.next.forEach((function(t){e.moveFlowItem(t)}))},deleteNextFlowItem:function(t){var e=this,n=this.getFlow(t),i=this.getFlowIndex(t);n&&(this.flowList.splice(i,1),this.$nextTick((function(){e.$options.jsPlumb.removeAllEndpoints(n.uuid)})),n.next.forEach((function(t){e.deleteNextFlowItem(t)})))},getFlow:function(t){var e=lt.a.find(this.flowList,(function(e){return e.uuid===t}));return e},getFlowIndex:function(t){var e=lt.a.findIndex(this.flowList,(function(e){return e.uuid===t}));return e},addTempFlowItem:function(t){var e=this.createFlowItem(m.tempNode,t);return this.draggableFlowConnect(t,e),e},addIfTempFlowItem:function(t){this.addIfOneTempFlowItem(t,!0),this.addIfOneTempFlowItem(t,!1)},addIfOneTempFlowItem:function(t,e){var n=this.getFlow(t),i=e?-ut:ut,o=this.createFlowItem(m.tempNode,t,{offsetLeft:i});return this.draggableFlowConnect(t,o),this.createFlowItemLabel(t,o,e?"是":"否"),e?n.nextIfId=o:n.nextElseId=o,o},addExpandTempFlowItem:function(t,e){var n,i=e.length,o=i%2===0,a=parseInt(i/2,10);a=o?a-1:a;for(var s={},l=0;l<=a;l++){n=e[l];var r=a-l,d=r*(2*ut);o&&(d+=ut),s.offsetLeft=-d;var u=this.createFlowItem(m.tempNode,t,s);this.draggableFlowConnect(t,u),this.createFlowItemLabel(t,u,n.name),n.nextStep=u}for(var c=a+1;c<i;c++){n=e[c];var f=o?c-(a+1):c-a,p=f*(2*ut);o&&(p+=ut),s.offsetLeft=p;var h=this.createFlowItem(m.tempNode,t,s);this.draggableFlowConnect(t,h),this.createFlowItemLabel(t,h,n.name),n.nextStep=h}},addExpandOneTempFlowItem:function(t,e,n){var i=this.createFlowItem(m.tempNode,t.uuid,{left:e});return this.draggableFlowConnect(t.uuid,i),this.createFlowItemLabel(t.uuid,i,n),i},addFlowItemConnect:function(t,e){this.draggableFlowConnect(t,e,!0),this.createFlowConnectionLabel(t,e)},handleChangeFlowPosition:function(t,e){var n=e.currentTarget,i=(""+n.style.left).replace("px",""),o=(""+n.style.top).replace("px","");t.left=Number(i),t.top=Number(o);var a=n.dataset.firstTime,s=(new Date).getTime();n.dataset.isClick=s-a<200},handleFlowMoveDown:function(t){var e=t.currentTarget;e.dataset.firstTime=(new Date).getTime()},handleTempFlowFormData:function(){var t=this,e=this.$refs.flowEditComponent;e&&e.validateFormData&&e.validateFormData().then((function(){var n=e.formData();if(t.dialogObj.isBetween)t.handleAddBetweenFlowItem({flowItemType:t.dialogObj.editType,preFlowId:t.dialogObj.flowPreUuid,nextFlowId:t.dialogObj.flowNextUuid,formData:n});else{var i=t.getFlow(t.dialogObj.flowUUid);i.formData=n,i.type===m.tempNode?t.handleAddFlowItem(t.dialogObj.editType,i.uuid):t.handleUpdateFlowItem({flowItemType:t.dialogObj.editType,tempFlowId:i.uuid})}t.initDialog()})).catch((function(){}))},handleCloseDialog:function(){this.initDialog()},handleGoList:function(){this.dialogObj.editType=m.list},showDialog:function(t){if(t.isBetween)this.dialogObj.isBetween=!0,this.dialogObj.flowPreUuid=t.flowPreUuid,this.dialogObj.flowNextUuid=t.flowNextUuid,this.dialogObj.editType=t.flowItemType||m.list;else{if(t.flowItemType===m.endNode)return void this.handleAddFlowItem(t.flowItemType,t.flowUuid);this.dialogObj.editType=t.flowItemType,this.dialogObj.flowUUid=t.flowUuid,t.flowFormData&&(this.dialogObj.editForm=t.flowFormData),t.flowItemType===m.tempNode&&(this.dialogObj.editType=m.list)}this.dialogObj.visible=!0},initDialog:function(){this.dialogObj.visible=!1,this.dialogObj.flowUUid=void 0,this.dialogObj.editType=void 0,this.dialogObj.isBetween=!1,this.dialogObj.flowPreUuid=void 0},formatData:function(){var t=this,e={},n={},i=[],o=v(this.flowList);return o.forEach((function(e){e.type===m.startNode&&e.formData.stepName;var o={elementId:e.id,stepId:e.uuid};if(e.next.length>1)if(t.isIfFlowItem(e.type)){var a=e.formData.ruleGroups||[],s={nextStep:e.nextIfId,name:"是",isDefault:!1,ruleGroups:a},l={nextStep:e.nextElseId,name:"否",isDefault:!0,ruleGroups:[]};o.nextSteps=[s,l],o.stepName=e.formData.stepName,o.stepJson=JSON.stringify({ifNodeTitle:e.formData.ifNodeTitle})}else if(t.isExpandFlowItem(e.type)){var r=e.formData.ruleGroupList,d=[];r.forEach((function(t){var e={nextStep:t.nextStep,name:t.name,ruleGroups:t.ruleGroups,isDefault:!!t.isDefault};d.push(e)})),o.nextSteps=d,o.stepName=e.formData.stepName}else o.nextSteps=e.next.map((function(t){return{nextStep:t}}));else o.nextStep=e.next[0]||null;t.isIfFlowItem(e.type)||t.isExpandFlowItem(e.type)||(o=Object.assign(o,e.formData)),i.push(o),n[e.uuid]={left:e.left,top:e.top}})),e.position=n,e.steps=i,e},handleMinusCanvas:function(){this.canvasDataRoom<=50||(this.canvasDataRoom=this.canvasDataRoom-10)},handlePlusCanvas:function(){100!==this.canvasDataRoom&&(this.canvasDataRoom=this.canvasDataRoom+10)},handleSort:function(){this.$_updatePosition()},handleClear:function(){var t=this;this.$confirm("确定要清空数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$_doClear()})).catch((function(){}))},$_updatePosition:function(){var t=this,e=lt.a.find(this.flowList,(function(e){return t.isStartFlowItem(e)}));e&&(this.$_updatePositionItemAndNext(e),this.$_plumbRepaintEverything())},$_updatePositionItemAndNext:function(t){var e=this;if(this.isStartFlowItem(t))t.top=mt,t.left=this.getFlowItemInitLeft();else{var n=this.getFlow(t.prev[0]);n&&(t.top=n.top+dt,this.isIfFlowItem(n.type)?t.uuid===n.nextIfId?(t.left=n.left-ut,this.isIfFlowItem(t.type)&&(t.left-=ct)):(t.left=n.left+ut,this.isIfFlowItem(t.type)&&(t.left+=ct)):this.isExpandFlowItem(n.type)||(t.left=n.left))}t.next.forEach((function(t){var n=e.getFlow(t);n&&e.$_updatePositionItemAndNext(n)}))},$_doClear:function(){var t=this,e=lt.a.find(this.flowList,(function(e){return t.isStartFlowItem(e)}));e&&(this.deleteNextFlowItem(e.uuid),this.$nextTick((function(){t.initFlow()})))},handleGetData:function(){var t=this,e=this.formatData(),n=new d.a(e,3);this.dialogVisible=!0,this.$nextTick((function(){t.$refs.preShow.appendChild(n.render())}))},_message:function(t,e){this.$message({type:e||"error",message:t})},isOnePreOneNext:function(t){return t.groupType===c.action||t.type===m.waitNode},isTempFlowItem:function(t){return t.type===m.tempNode},isStartFlowItem:function(t){return t.type===m.startNode},isEndFlowItem:function(t){return t.type===m.endNode},isIfFlowItem:function(t){return t===m.ifNode},isExpandFlowItem:function(t){return t===m.expandNode},isHasMoreNextFlowItem:function(t){return this.isHasMoreNextFlowItemByType(t.type)},isHasMoreNextFlowItemByType:function(t){return this.isIfFlowItem(t)||this.isExpandFlowItem(t)},isHasStepCountFlowItem:function(t){return t.groupType===c.action||t.type===m.startNode}}},pt=ft,ht=(n("d4ee"),Object(D["a"])(pt,s,l,!1,null,null,null)),wt=ht.exports,vt={name:"App",components:{Workflow:wt}},gt=vt,It=Object(D["a"])(gt,o,a,!1,null,null,null),Ft=It.exports,xt=n("5c96"),bt=n.n(xt);n("0fae");i["default"].config.productionTip=!1,i["default"].use(bt.a),new i["default"]({render:function(t){return t(Ft)}}).$mount("#app")},6523:function(t,e,n){"use strict";var i=n("ff6f"),o=n.n(i);o.a},"83c4":function(t,e,n){},b37d:function(t,e,n){},d4ee:function(t,e,n){"use strict";var i=n("83c4"),o=n.n(i);o.a},fc80:function(t,e,n){"use strict";(function(t){n("99af"),n("4de4"),n("4160"),n("caad"),n("c975"),n("d81d"),n("a434");var i=n("2909"),o=n("53fe");function a(){return"undefined"!==typeof window?window.console:t.console}var s=a();function l(t,e,n){return void 0==n||(t=null==t?{}:t,t[e]=n),t}function r(t){null!==t.parentElement&&t.parentElement.removeChild(t)}function d(t,e,n){var i=0===n?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,i)}function u(t,e){return t.map((function(t){return t.elm})).indexOf(e)}function c(t,e,n){if(!t)return[];var o=t.map((function(t){return t.elm})),a=Object(i["a"])(e).map((function(t){return o.indexOf(t)}));return n?a.filter((function(t){return-1!==t})):a}function m(t,e){var n=this;this.$nextTick((function(){return n.$emit(t.toLowerCase(),e)}))}function f(t){var e=this;return function(n){null!==e.realList&&e["onDrag"+t](n),m.call(e,t,n)}}function p(t){if(!t)return!1;var e=t.pull;return"function"===typeof e?"clone"===e():"clone"===e}var h=["Start","Add","Remove","Update","End"],w=["Choose","Sort","Filter","Clone"],v=["Move"].concat(h,w).map((function(t){return"on"+t})),g=null,I={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},F={name:"draggable",inheritAttrs:!0,props:I,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1,init:!1,isCloning:!1}},render:function(t){var e=this.$slots.default;if(e&&1===e.length){var n=e[0];n.componentOptions&&["transition-group","TransitionGroup"].includes(n.componentOptions.tag)&&(this.transitionMode=!0)}var o=0,a=e,s=this.$slots,r=s.header,d=s.footer;r&&(o=r.length,a=a?[].concat(Object(i["a"])(r),Object(i["a"])(a)):Object(i["a"])(r)),d&&(a=a?[].concat(Object(i["a"])(a),Object(i["a"])(d)):Object(i["a"])(d)),this.headerOffset=o;var u=null,c=function(t,e){u=l(u,t,e)};if(this.componentData){var m=this.componentData,f=m.on,p=m.props;c("on",f),c("props",p)}return t(this.getTag(),u,a)},created:function(){null!==this.list&&null!==this.value&&s.error("Value and list props are mutually exclusive! Please set one or another."),"div"!==this.element&&s.warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),void 0!==this.options&&s.warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var t=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var e={};h.forEach((function(n){e["on"+n]=f.call(t,n)})),w.forEach((function(n){e["on"+n]=m.bind(t,n)}));var n=Object.assign({},this.options,this.$attrs,e,{onMove:function(e,n){return t.onDragMove(e,n)}});!("draggable"in n)&&(n.draggable=">*"),this._sortable=new o(this.rootContainer,n),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(t){this.updateOptions(t)},deep:!0},$attrs:{handler:function(t){this.updateOptions(t)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getTag:function(){return this.tag||this.element},getIsCloning:function(){var t=this.$attrs.group,e=t||this.getOptionGroup();return p(e)},getOptionGroup:function(){var t=this.options;if(t)return t.group},updateOptions:function(t){for(var e in t)-1==v.indexOf(e)&&this._sortable.option(e,t[e])},getChildrenNodes:function(){if(this.init||(this.noneFunctionalComponentMode=this.noneFunctionalComponentMode&&1==this.$children.length,this.init=!0),this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick((function(){t.visibleIndexes=c(t.getChildrenNodes(),t.rootContainer.children,t.transitionMode)}))},getUnderlyingVm:function(t){var e=u(this.getChildrenNodes()||[],t);if(-1===e)return null;var n=this.realList[e];return{index:e,element:n}},getUnderlyingPotencialDraggableComponent:function(t){var e=t.__vue__;return e&&e.$options&&"transition-group"===e.$options._componentTag?e.$parent:e},emitChanges:function(t){var e=this;this.$nextTick((function(){e.$emit("change",t)}))},alterList:function(t){if(this.list)t(this.list);else{var e=Object(i["a"])(this.value);t(e),this.$emit("input",e)}},spliceList:function(){var t=arguments,e=function(e){return e.splice.apply(e,Object(i["a"])(t))};this.alterList(e)},updatePosition:function(t,e){var n=function(n){return n.splice(e,0,n.splice(t,1)[0])};this.alterList(n)},getRelatedContextFromMoveEvent:function(t){var e=t.to,n=t.related,i=this.getUnderlyingPotencialDraggableComponent(e);if(!i)return{component:i};var o=i.realList,a={list:o,component:i};if(e!==n&&o&&i.getUnderlyingVm){var s=i.getUnderlyingVm(n);if(s)return Object.assign(s,a)}return a},getVmIndex:function(t){var e=this.visibleIndexes,n=e.length;return t>n-1?n:e[t]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(t){if(this.noTransitionOnDrag&&this.transitionMode){var e=this.getChildrenNodes();e[t].data=null;var n=this.getComponent();n.children=[],n.kept=void 0}},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),this.isCloning=this.getIsCloning(),t.item._underlying_vm_=this.clone(this.context.element),g=t.item},onDragAdd:function(t){var e=t.item._underlying_vm_;if(void 0!==e){r(t.item);var n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();var i={element:e,newIndex:n};this.emitChanges({added:i})}},onDragRemove:function(t){if(d(this.rootContainer,t.item,t.oldIndex),this.isCloning)r(t.clone);else{var e=this.context.index;this.spliceList(e,1);var n={element:this.context.element,oldIndex:e};this.resetTransitionData(e),this.emitChanges({removed:n})}},onDragUpdate:function(t){r(t.item),d(t.from,t.item,t.oldIndex);var e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);var i={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:i})},updateProperty:function(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},computeFutureIndex:function(t,e){if(!t.element)return 0;var n=Object(i["a"])(e.to.children).filter((function(t){return"none"!==t.style["display"]})),o=n.indexOf(e.related),a=t.component.getVmIndex(o),s=-1!=n.indexOf(g);return s||!e.willInsertAfter?a:a+1},onDragMove:function(t,e){var n=this.move;if(!n||!this.realList)return!0;var i=this.getRelatedContextFromMoveEvent(t),o=this.context,a=this.computeFutureIndex(i,t);return Object.assign(o,{futureIndex:a}),Object.assign(t,{relatedContext:i,draggedContext:o}),n(t,e)},onDragEnd:function(){this.computeIndexes(),g=null}}};e["a"]=F}).call(this,n("c8ba"))},ff6f:function(t,e,n){}});
//# sourceMappingURL=app.0eb70aa0.js.map